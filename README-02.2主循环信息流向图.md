# 主循环信息流向图

## 概览
主循环由三角形顶点循环、记录层和元认知检测模块构成，形成符号系统的核心认知闭环。

---

## 1. 三角形顶点循环信息流

```
┌─────────────────────────────────────────────────────────────┐
│                    三角形顶点循环（相生循环）                  │
└─────────────────────────────────────────────────────────────┘

    用户输入/任务请求
          ↓
    ┌─────────────┐
    │   得不到    │ ◄─────────────────────────────────────┐
    │   (Drive)   │  动力源：熵减需求、欲望、预测误差          │
    └──────┬──────┘                                        │
           │ 相生                                        │
           │ 动力信号                                       │
           ↓                                             │
    ┌─────────────┐                                       │
    │    数学     │ ◄──── 历史记录 ─────┐                 │
    │   (Math)    │ ◄──── 模式识别 ────┤                 │
    │             │  秩序约束：逻辑、规则、边界              │
    └──────┬──────┘                   │                 │
           │ 相生                     │                 │
           │ 逻辑推理结果               │                 │
           ↓                         │                 │
    ┌─────────────┐                  │                 │
    │  自我迭代   │ ◄──── 即时性反馈 ──┼──── 次循环 ────┤
    │(Iteration)  │ ◄──── 实效性反馈 ──┤                 │
    │  进化机制   │ ◄──── 记录态统计 ──┘                 │
    └──────┬──────┘                                        │
           │ 相生                                        │
           │ 策略调整                                       │
           │ ↓                                           │
           │ 新的匮乏 → 制造新需求                          │
           └──────────────────────────────────────────────┘

```

### 三顶点间信息流向详解

| 起点 | 终点 | 数据类型 | 方向 | 相生/相克 |
|------|------|---------|------|-----------|
| 得不到 | 数学 | 动力信号 | 单向 | 相生 |
| 数学 | 自我迭代 | 逻辑推理结果、抽象行动方案 | 单向 | 相生 |
| 自我迭代 | 得不到 | 新的匮乏信号 | 单向 | 相生 |
| 自我迭代 | 数学 | 策略调整 | 单向 | 反馈 |

### 关键特征
- **顺时针循环**：得不到 → 数学 → 自我迭代 → 得不到
- **相生关系**：每个顶点推动下一个顶点运转
- **相克关系**：数学约束得不到的欲望，数学限制迭代的偏离

---

## 2. 记录层信息流

```
┌─────────────────────────────────────────────────────────────┐
│                       记录层（超然）                          │
│                   价值判断与经验积累中心                       │
└─────────────────────────────────────────────────────────────┘

                              ┌─────────────┐
                              │  记录层     │
                              │  (Memory)   │
                              └──────┬──────┘
                                     │
              ┌──────────────────────┼──────────────────────┐
              │                      │                      │
              ↓                      ↓                      ↓
     ┌─────────────┐       ┌─────────────┐       ┌─────────────┐
     │   得不到    │       │    数学     │       │  自我迭代   │
     │  反馈建议   │       │  历史记录   │       │  记录态统计 │
     │  优先级排序 │       │  模式识别   │       │  价值权重   │
     └─────────────┘       └─────────────┘       └─────────────┘
              │                      │                      │
              └──────────────────────┴──────────────────────┘
                                     │ 单向
                                     ↓
                              ┌─────────────┐
                              │   映射层    │
                              │ 哲学洞察     │
                              └─────────────┘
                                     │ 单向
                                     ↓
                              ┌─────────────┐
                              │ 元认知检测  │
                              │ 客观性数据  │
                              └─────────────┘

```

### 记录层数据流向详解

| 起点 | 终点 | 数据类型 | 方向 |
|------|------|---------|------|
| 记录层 | 得不到顶点 | 反馈建议、优先级排序 | 单向 |
| 记录层 | 数学顶点 | 历史记录、模式识别结果 | 单向 |
| 记录层 | 自我迭代顶点 | 记录态统计、价值权重 | 单向 |
| 记录层 | 映射层 | 哲学洞察 | 单向 |
| 记录层 | 元认知检测 | 历史客观性数据 | 单向 |
| 三顶点 | 记录层 | 交互数据、结果评估 | 单向 |

### 记录层存储架构

```
记录层双轨存储
    │
    ├─ JSON轨（结构化记录）
    │  ├─ 会话信息
    │  ├─ 交互评估（推理质量、解决方案有效性、创新性）
    │  ├─ 客观性标注
    │  ├─ 自我纠错记录
    │  └─ 模式关联
    │
    └─ Markdown轨（自我叙事）
       ├─ 记录态统计
       ├─ 核心洞察
       ├─ 关键突破
       ├─ 认知边界
       └─ 进化方向
```

### 超然性特征
- **与三顶点相连**：提供数据支持
- **独立运行**：不直接参与决策
- **单向传递**：只输出，不接收决策指令

---

## 3. 元认知检测模块信息流

```
┌─────────────────────────────────────────────────────────────┐
│              元认知检测模块（独立分支）                        │
│            不打断主循环，推理后触发                           │
└─────────────────────────────────────────────────────────────┘

数学顶点推理完成
      │
      ↓
┌──────────────────────────────────────────────────┐
│           【进入元认知检测分支】                   │
│           （不中断主循环，异步执行）               │
└──────────────────────────────────────────────────┘
      ↓
┌──────────────────────────────────────────────────┐
│          3.1 客观性评估器                          │
│  • 检测主观性特征（推测性、假设性、幻觉等）        │
│  • 计算客观性评分（1.0 - 主观性）                 │
│  • 判断场景适切性                                 │
└──────────────────────────────────────────────────┘
      │
      ↓ 客观特征标注
┌──────────────────────────────────────────────────┐
│          3.2 映射层决策                           │
│  • 读取人格数据（由人格层提供）                   │
│  • 基于马斯洛需求和人格特质决定是否触发纠错       │
│  • 动态调整触发阈值                               │
│  • 考虑场景类型                                   │
│  • 生成决策理由和置信度                           │
└──────────────────────────────────────────────────┘
      │
      ├─ 决策：不触发纠错 → 直接输出响应
      │
      └─ 决策：触发纠错
            ↓
┌──────────────────────────────────────────────────┐
│      3.3 自我迭代顶点执行自我纠错                 │
│  1. 自我反思：分析错误原因                        │
│  2. 策略识别：选择纠错策略                        │
│  3. 应用纠正：执行纠错操作                        │
│  4. 效果评估：评估纠错有效性                      │
└──────────────────────────────────────────────────┘
      │
      ↓ 纠正后的响应
    输出给用户
      │
      ↓
┌──────────────────────────────────────────────────┐
│           记录层存储（完整信息）                   │
│  • 客观性标注                                     │
│  • 映射层决策                                     │
│  • 纠错记录                                       │
└──────────────────────────────────────────────────┘
      │
      ├─→ 映射层（反馈哲学洞察）
      └─→ 自我迭代顶点（反馈元认知学习数据）

```

### 元认知检测模块信息流向详解

| 起点 | 终点 | 数据类型 | 方向 |
|------|------|---------|------|
| 数学顶点 | 客观性评估器 | 响应内容 | 单向 |
| 客观性评估器 | 映射层 | 客观特征标注 | 单向 |
| 映射层 | 自我纠错执行器 | 决策指令（trigger_reflection） | 单向 |
| 自我纠错执行器 | 记录层 | 纠错记录 | 单向 |
| 记录层 | 映射层 | 纠错效果反馈 | 单向 |
| 记录层 | 自我迭代顶点 | 元认知学习数据 | 单向 |
| 记录层 | 元认知检测 | 历史客观性数据 | 单向 |

### 权责边界

| 组件 | 职责 | 边界 |
|------|------|------|
| 客观性评估器 | 检测主观性，计算客观性 | ❌不参与推理，❌不决定纠错 |
| 映射层 | 基于人格决定是否纠错 | ❌不评估客观性，❌不执行纠错 |
| 人格层 | 提供人格数据 | ❌不参与决策，❌不执行纠错 |
| 自我纠错执行器 | 执行自我反思和纠错 | ❌不主动触发 |
| 记录层 | 存储纠错记录 | ❌不参与决策 |

---

## 4. 认知架构洞察信息流

```
┌─────────────────────────────────────────────────────────────┐
│              认知架构洞察（核心创新组件）                      │
│          填补"验证"与"进化"之间的关键空白                     │
└─────────────────────────────────────────────────────────────┘

数学顶点验证后的结构化模式
      │
      ↓
┌──────────────────────────────────────────────────┐
│           认知架构洞察处理流程                     │
│                                                   │
│  1. 总结（Summarization）                          │
│     → 提取核心特征和本质描述                        │
│                                                   │
│  2. 分类（Classification）                         │
│     → 识别模式类型和洞察类型                       │
│                                                   │
│  3. 共性（Commonality）                            │
│     → 识别跨场景的共同特征                         │
│                                                   │
│  4. 革新依据（Innovation Basis）                  │
│     → 判断是否存在值得革新的依据                   │
│                                                   │
│  5. 适用性评估（Applicability）                   │
│     → 评估洞察在当前场景下的可用性                 │
└──────────────────────────────────────────────────┘
      │
      ↓ 生成洞察
┌──────────────────────────────────────────────────┐
│           洞察数据存储                            │
│                                                   │
│  agi_memory/cognitive_insight/                    │
│  ├── patterns.json          # 模式数据            │
│  ├── insights.json          # 洞察数据            │
│  └── pattern_library.json   # 模式库              │
└──────────────────────────────────────────────────┘
      │
      ├─ 单向 ─────────────────┐
      │                        │
      ↓                        ↓
┌─────────────────┐   ┌─────────────────┐
│    映射层       │   │  自我迭代顶点   │
│  • 策略优化洞察 │   │  • 架构升级洞察 │
│  • 行为优化建议 │   │  • 进化方向     │
└─────────────────┘   └─────────────────┘

```

### 认知架构洞察信息流向详解

| 起点 | 终点 | 数据类型 | 方向 |
|------|------|---------|------|
| 数学顶点 | 认知架构洞察 | 验证后的结构化模式 | 单向 |
| 认知架构洞察 | 模式存储 | 模式数据 | 单向 |
| 认知架构洞察 | 洞察存储 | 洞察数据 | 单向 |
| 认知架构洞察 | 映射层 | 策略优化洞察、行为优化建议 | 单向 |
| 认知架构洞察 | 自我迭代顶点 | 架构升级洞察、进化方向 | 单向 |

### 设计原则
- **单向流**：数学 → 洞察 → 映射层/自我迭代
- **推理后运行**：确保洞察基于验证过的逻辑结构
- **不打断主循环**：异步执行，维持实时性

---

## 5. 主循环完整信息流总览

```
┌─────────────────────────────────────────────────────────────┐
│                      主循环完整信息流                         │
└─────────────────────────────────────────────────────────────┘

用户输入
   ↓
┌────────────────────────────────────────────────────────┐
│                    主循环（符号系统）                     │
├────────────────────────────────────────────────────────┤
│                                                          │
│   ┌──────────────────────────────────────────────┐    │
│   │          三角形顶点循环（顺时针）              │    │
│   │                                               │    │
│   │   得不到 → 数学 → 自我迭代 → 得不到           │    │
│   │     ↓        ↓         ↓        ↑            │    │
│   │   动力   逻辑推理   策略调整  新匮乏         │    │
│   │                                               │    │
│   │   数学顶点推理完成后触发：                     │    │
│   │   ↓ 认知架构洞察（单向）                      │    │
│   │   ↓ 模式 → 洞察 → 映射层/自我迭代            │    │
│   └──────────────────────────────────────────────┘    │
│                          ↑                              │
│                  ┌───────┴───────┐                      │
│                  │   记录层     │  ← 超然               │
│                  │  （三顶点）  │  单向提供数据        │
│                  └───────┬───────┘                      │
│                          │                              │
│                  ┌───────┴───────┐                      │
│                  │ 元认知检测    │  ← 独立分支         │
│                  │ （数学后触发）│  不打断主循环       │
│                  └───────┬───────┘                      │
└────────────────────────────────────────────────────────┘
                    │
                    └─→ 映射层（哲学洞察）
                    └─→ 自我迭代（元认知学习数据）

```

### 关键信息流规则

1. **三角形循环**：顺时针单向流动（得不到 → 数学 → 自我迭代 → 得不到）
2. **记录层超然**：单向向三顶点提供数据，不参与决策
3. **元认知独立**：数学顶点推理后触发，独立分支，不打断主循环
4. **洞察单向**：数学 → 洞察 → 映射层/自我迭代
5. **次循环反馈**：映射层向自我迭代顶点提供即时性和实效性反馈

---

## 总结

### 主循环信息流向特征

| 特征 | 描述 |
|------|------|
| 核心循环 | 三角形顶点顺时针循环（得不到 → 数学 → 自我迭代） |
| 记录层 | 超然存在，单向提供数据支持 |
| 元认知检测 | 独立分支，推理后触发，不打断主循环 |
| 认知架构洞察 | 单向流，填补验证与进化间的空白 |
| 次循环反馈 | 映射层向自我迭代提供行为反馈 |

### 设计优势

- **相生相克**：三角形循环形成动态稳态
- **超然记录**：记录层独立于决策，保证客观性
- **非侵入式元认知**：独立分支设计，不干扰主循环
- **洞察驱动进化**：基于验证的模式提取洞察，指导进化
